{{/* Displays cards with child page titles, their total count, a description or summary, and optionally quick buttons to the first 3 children. */}}

{{ if .Site.Params.childPages.display}}
    {{if .Pages }}
        <aside class="spread c-pinned-top">
            {{ range sort .Pages "Weight" "$order"}}
                <section class="is-one-third is-fullsize-mobile c-sp-1 mt-5">
                        <h3 class="m">{{.Title}}</h3>
                        {{if .Description}}
                            <p class="subtitle-1">{{.Description}}</p>
                        {{end}}
                        {{if eq .Params.label "required"}}
                                    <div class="label black">REQUIRED</div>
                                {{else if eq .Params.label "optional"}}
                                     <div class="label white">OPTIONAL</div>
                                {{end}}
                        {{ if .Site.Params.childPages.grandchildren}}
                            <div class="spread-left">
                                {{ range first 7 .Pages }}
                                <a class="button outlined-black p-1 mt-1 mr-1 xs is-fit rounded-1" href="{{ .Permalink }}"> {{if .Title}}{{.Title | truncate 30}}{{else}}{{ path.BaseName . | humanize | truncate 30}}{{end}}
                                </a>
                                {{ end }}
                                {{if .Pages}}
                                <a class="button black p-1 mt-1 mr-1 xs is-fit rounded-1" href="{{ .Permalink }}"> View All </a>
                                {{else}} 
                                {{end}}
                            </div>
                        {{else}}
                            <div class="label black"> {{ len (.Pages) }} articles</div>  
                        {{end}}
                </section>
            {{end}}
        </aside>
    {{end}}
{{end}}